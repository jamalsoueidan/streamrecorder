"use server";

import { ScopeEnum } from "@/lib/types/strapi-autogenerated";
import api from "../../lib/api";

export async function getRecordings(
  scope: ScopeEnum,
  page: number,
  sort: string = "createdAt:asc"
) {
  const response = await api.recording.browseRecordings({
    scope,
    "pagination[page]": page,
    "pagination[pageSize]": 10,
    populate: {
      sources: {
        fields: ["id", "documentId", "path", "duration"],
      },
      follower: {
        fields: ["username", "type"],
      },
    },
    sort,
  });

  return {
    data: response.data?.data || [],
    meta: response.data?.meta,
  };
}
