import { FollowerTypeIcon } from "@/app/[locale]/(protected)/components/follower-type-icon";

import {
  Clip,
  Follower,
  FollowerTypeEnum,
} from "@/lib/types/strapi-autogenerated";
import { headers } from "next/headers";
import { VideoPlayer } from "./video-player";

interface Props {
  clip: Clip & { follower: Follower | null };
  type: FollowerTypeEnum;
}

export async function ImageClipPreview({ clip, type }: Props) {
  const headersList = await headers();
  const userAgent = headersList.get("user-agent") || "";
  const previewUrl = `/clip/${clip.documentId}/thumbnail.jpg`;

  return (
    <div style={{ position: "relative" }}>
      <VideoPlayer
        previewUrl={previewUrl}
        src={`/clip/${clip.documentId}/short.mp4`}
        userAgent={userAgent}
      />

      <FollowerTypeIcon
        type={type}
        color="black"
        opacity={0.8}
        pos="absolute"
        top={20}
        right={18}
        style={{
          pointerEvents: "none",
        }}
      />
    </div>
  );
}
