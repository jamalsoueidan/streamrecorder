// _components/video-modal-by-follower.tsx
"use client";

import { Source } from "@/lib/types/strapi-autogenerated";
import { useSearchParams } from "next/navigation";
import { useCallback } from "react";
import { VideoModal } from "./video-modal";

interface Props {
  initialId: string;
  username: string;
  type: string;
  initialSources: Source[];
  initialPrevId: string | null;
  initialNextId: string | null;
}

export function VideoModalByRecordings({
  initialId,
  username,
  type,
  initialSources,
  initialPrevId,
  initialNextId,
}: Props) {
  const searchParams = useSearchParams();
  const sort = searchParams.get("sort") || "createdAt:desc";

  const loadVideo = useCallback(
    async (id: string) => {
      const res = await fetch(
        `/api/recordings/with-prev-next?id=${id}&sort=${sort}`
      );
      return res.json();
    },
    [sort]
  );

  return (
    <VideoModal
      initialId={initialId}
      username={username}
      type={type}
      initialSources={initialSources}
      initialPrevId={initialPrevId}
      initialNextId={initialNextId}
      onLoadVideo={loadVideo}
    />
  );
}
